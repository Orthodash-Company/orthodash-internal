(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{14099:(e,s,a)=>{"use strict";a.d(s,{J:()=>c});var t=a(37876),i=a(14232),r=a(59773),l=a(47137),n=a(56680);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.b,{ref:s,className:(0,n.cn)(d(),a),...i})});c.displayName=r.b.displayName},26283:(e,s,a)=>{"use strict";a.d(s,{$:()=>c,r:()=>d});var t=a(37876),i=a(14232),r=a(82987),l=a(47137),n=a(56680);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,s)=>{let{className:a,variant:i,size:l,asChild:c=!1,...o}=e,m=c?r.DX:"button";return(0,t.jsx)(m,{className:(0,n.cn)(d({variant:i,size:l,className:a})),ref:s,...o})});c.displayName="Button"},26625:(e,s,a)=>{"use strict";a.d(s,{p:()=>l});var t=a(37876),i=a(14232),r=a(56680);let l=i.forwardRef((e,s)=>{let{className:a,type:i,...l}=e;return(0,t.jsx)("input",{type:i,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"},43579:(e,s,a)=>{"use strict";a.d(s,{dj:()=>m});var t=a(14232);let i=0,r=new Map,l=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},n=[],d={toasts:[]};function c(e){d=((e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=s;return a?l(a):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}})(d,e),n.forEach(e=>{e(d)})}function o(e){let{...s}=e,a=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),t=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:e=>{e||t()}}}),{id:a,dismiss:t,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,s]=t.useState(d);return t.useEffect(()=>(n.push(s),()=>{let e=n.indexOf(s);e>-1&&n.splice(e,1)}),[e]),{...e,toast:o,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},55575:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>sT});var t=a(37876),i=a(14232),r=a(91196),l=a(77471),n=a(32002),d=a(51165),c=a(40049),o=a(84399),m=a(26283),x=a(78820),h=a(3738),u=a(10458),p=a(72806),f=a(56680);let j=x.bL,g=x.l9;x.YJ,x.ZL,x.Pb,x.z6,i.forwardRef((e,s)=>{let{className:a,inset:i,children:r,...l}=e;return(0,t.jsxs)(x.ZP,{ref:s,className:(0,f.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",i&&"pl-8",a),...l,children:[r,(0,t.jsx)(h.A,{className:"ml-auto"})]})}).displayName=x.ZP.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(x.G5,{ref:s,className:(0,f.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...i})}).displayName=x.G5.displayName;let v=i.forwardRef((e,s)=>{let{className:a,sideOffset:i=4,...r}=e;return(0,t.jsx)(x.ZL,{children:(0,t.jsx)(x.UC,{ref:s,sideOffset:i,className:(0,f.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",a),...r})})});v.displayName=x.UC.displayName;let N=i.forwardRef((e,s)=>{let{className:a,inset:i,...r}=e;return(0,t.jsx)(x.q7,{ref:s,className:(0,f.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",i&&"pl-8",a),...r})});N.displayName=x.q7.displayName,i.forwardRef((e,s)=>{let{className:a,children:i,checked:r,...l}=e;return(0,t.jsxs)(x.H_,{ref:s,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:r,...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(x.VF,{children:(0,t.jsx)(u.A,{className:"h-4 w-4"})})}),i]})}).displayName=x.H_.displayName,i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(x.hN,{ref:s,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(x.VF,{children:(0,t.jsx)(p.A,{className:"h-2 w-2 fill-current"})})}),i]})}).displayName=x.hN.displayName;let y=i.forwardRef((e,s)=>{let{className:a,inset:i,...r}=e;return(0,t.jsx)(x.JU,{ref:s,className:(0,f.cn)("px-2 py-1.5 text-sm font-semibold",i&&"pl-8",a),...r})});y.displayName=x.JU.displayName;let b=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(x.wv,{ref:s,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",a),...i})});b.displayName=x.wv.displayName;var w=a(67768),A=a(40097),C=a(91725),S=a(47137);let D=(0,S.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function k(e){let{className:s,variant:a,...i}=e;return(0,t.jsx)("div",{className:(0,f.cn)(D({variant:a}),s),...i})}function P(e){let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,f.cn)("animate-pulse rounded-md bg-muted",s),...a})}var R=a(16624),I=a(97842);let F=R.bL,T=R.l9,z=R.ZL;R.bm;let E=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.hJ,{ref:s,className:(0,f.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i})});E.displayName=R.hJ.displayName;let O=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(z,{children:[(0,t.jsx)(E,{}),(0,t.jsxs)(R.UC,{ref:s,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r,children:[i,(0,t.jsxs)(R.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(I.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});O.displayName=R.UC.displayName;let L=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};L.displayName="DialogHeader";let $=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.hE,{ref:s,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight",a),...i})});$.displayName=R.hE.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.VY,{ref:s,className:(0,f.cn)("text-sm text-muted-foreground",a),...i})}).displayName=R.VY.displayName;var J=a(46060);let M=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(J.bL,{ref:s,className:(0,f.cn)("relative overflow-hidden",a),...r,children:[(0,t.jsx)(J.LM,{className:"h-full w-full rounded-[inherit]",children:i}),(0,t.jsx)(_,{}),(0,t.jsx)(J.OK,{})]})});M.displayName=J.bL.displayName;let _=i.forwardRef((e,s)=>{let{className:a,orientation:i="vertical",...r}=e;return(0,t.jsx)(J.VM,{ref:s,orientation:i,className:(0,f.cn)("flex touch-none select-none transition-colors","vertical"===i&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===i&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...r,children:(0,t.jsx)(J.lr,{className:"relative flex-1 rounded-full bg-border"})})});_.displayName=J.VM.displayName;var G=a(28364),Z=a(46618),U=a(36535),W=a(21744),B=a(12844);async function q(e){if(!e.ok){let s=await e.text()||e.statusText;throw Error("".concat(e.status,": ").concat(s))}}async function V(e,s,a){let t=await fetch(s,{method:e,headers:a?{"Content-Type":"application/json"}:{},body:a?JSON.stringify(a):void 0,credentials:"include"});return await q(t),t}function H(e){let{trigger:s}=e,a=(0,w.jE)(),{data:i=[],isLoading:l,error:n}=(0,r.I)({queryKey:["/api/reports"]}),d=(0,A.n)({mutationFn:async e=>{await V("DELETE","/api/reports/".concat(e))},onSuccess:()=>{a.invalidateQueries({queryKey:["/api/reports"]})}}),c=(0,A.n)({mutationFn:async e=>(await V("POST","/api/reports/".concat(e,"/pdf"))).blob(),onSuccess:(e,s)=>{let a=window.URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download="orthodash-report-".concat(s,".pdf"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a),document.body.removeChild(t)}}),o=async e=>{window.confirm("Are you sure you want to delete this report?")&&d.mutate(e)},x=(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(G.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Reports"})]});return(0,t.jsxs)(F,{children:[(0,t.jsx)(T,{asChild:!0,children:s||x}),(0,t.jsxs)(O,{className:"max-w-4xl max-h-[90vh]",children:[(0,t.jsx)(L,{children:(0,t.jsx)($,{children:"Saved Reports"})}),(0,t.jsx)(M,{className:"h-[70vh]",children:l?(0,t.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,s)=>(0,t.jsxs)(C.Zp,{children:[(0,t.jsxs)(C.aR,{children:[(0,t.jsx)(P,{className:"h-4 w-3/4"}),(0,t.jsx)(P,{className:"h-3 w-1/2"})]}),(0,t.jsx)(C.Wu,{children:(0,t.jsx)(P,{className:"h-20 w-full"})})]},s))}):n?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)("div",{className:"rounded-full bg-red-100 p-3 mb-4",children:(0,t.jsx)(G.A,{className:"h-8 w-8 text-red-400"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Reports"}),(0,t.jsx)("p",{className:"text-gray-500",children:"There was an error loading your saved reports. Please try again."})]}):0===i.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)("div",{className:"rounded-full bg-gray-100 p-3 mb-4",children:(0,t.jsx)(G.A,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Reports Saved"}),(0,t.jsx)("p",{className:"text-gray-500 max-w-sm",children:"You haven't saved any reports yet. Create a period comparison and save it as a template to get started."})]}):(0,t.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,t.jsxs)(C.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(C.ZB,{className:"text-base",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.id,void c.mutate(s)},disabled:c.isPending,children:(0,t.jsx)(Z.A,{className:"h-4 w-4"})}),(0,t.jsx)(m.$,{variant:"ghost",size:"sm",onClick:()=>o(e.id),disabled:d.isPending,children:(0,t.jsx)(U.A,{className:"h-4 w-4 text-red-500"})})]})]})}),(0,t.jsx)(C.Wu,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Created ",(0,B.GP)(new Date(e.createdAt),"MMM d, yyyy")]})]}),e.pdfUrl&&(0,t.jsx)(k,{variant:"secondary",className:"text-xs",children:"PDF Available"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Periods (",e.periodConfigs.length,")"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.periodConfigs.map((e,s)=>(0,t.jsx)(k,{variant:"outline",className:"text-xs",children:e.title},s))})]}),e.thumbnail&&(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsx)("img",{src:e.thumbnail,alt:"".concat(e.name," preview"),className:"w-full h-24 object-cover rounded-lg border"})})]})})]},e.id))})})]})]})}function K(){let{user:e,logoutMutation:s}=(0,o.As)();return(0,t.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("a",{href:"/",className:"flex-shrink-0 flex items-center hover:opacity-80 transition-opacity",children:[(0,t.jsx)(l.A,{className:"text-[#1d1d52] mr-2 sm:mr-3",size:28}),(0,t.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"ORTHODASH"})]})}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[e&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(H,{trigger:(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-[#1d1d52] hover:bg-gray-100",children:[(0,t.jsx)(n.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline ml-2",children:"Report History"})]})})}),e&&(0,t.jsxs)(j,{children:[(0,t.jsx)(g,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"ghost",size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(d.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline text-sm",children:e.email})]})}),(0,t.jsxs)(v,{align:"end",className:"w-56",children:[(0,t.jsx)(y,{children:"My Account"}),(0,t.jsx)(b,{}),(0,t.jsx)(N,{className:"text-sm text-gray-600",children:e.email}),(0,t.jsx)(b,{}),(0,t.jsxs)(N,{className:"text-red-600 cursor-pointer",onClick:()=>{s.mutate()},disabled:s.isPending,children:[(0,t.jsx)(c.A,{className:"mr-2 h-4 w-4"}),s.isPending?"Logging out...":"Logout"]})]})]})]})]})})})}new(a(90948)).E({defaultOptions:{queries:{queryFn:(e=>{let{on401:s}=e;return async e=>{let{queryKey:a}=e,t=await fetch(a[0],{credentials:"include"});return"returnNull"===s&&401===t.status?null:(await q(t),await t.json())}})({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:3e5,retry:2},mutations:{retry:!1}}});var Y=a(15989),Q=a(18047),X=a(50843),ee=a(51209),es=a(97730),ea=a(43579);let et=[{id:"doughnut-referral-sources",type:"doughnut",title:"Doughnut Chart - Referral Sources",description:"Customizable colors and data labels showing referral source distribution",summary:"A circular visualization that clearly shows the proportion of patients coming from different referral sources, making it easy to identify your most valuable referral channels.",explanation:"This chart displays referral sources as segments of a doughnut, with customizable colors and percentage labels. You can analyze patterns by office or view total practice data to understand which marketing channels drive the most new patients.",icon:Y.A,options:["By Office","Total Practice","Custom Colors","Show Percentages"]},{id:"column-multi-series",type:"column",title:"Column Chart - Multiple Series",description:"Referral Sources and TC Conversion Rates comparison",summary:"Side-by-side columns comparing referral volume against treatment coordinator conversion rates, revealing which sources provide the highest quality leads.",explanation:"This multi-series column chart shows both referral volumes and TC conversion rates, allowing you to identify not just which sources bring the most patients, but which ones convert best. Essential for optimizing marketing spend and TC training focus.",icon:Q.A,options:["Total Practice","By Treatment Coordinator","By Office","Show Conversion %"]},{id:"spline-multi-series",type:"spline",title:"Spline Chart - Referral Source Trends",description:"Multi-series trend analysis of referral sources over time",summary:"Smooth trend lines showing how different referral sources perform over time, helping identify seasonal patterns and growth trends in your patient acquisition.",explanation:"This spline chart tracks referral source performance across time periods, revealing seasonal trends, marketing campaign effectiveness, and long-term growth patterns. Critical for strategic planning and budget allocation.",icon:l.A,options:["Monthly Trends","Quarterly View","By Source Type","Smooth Curves"]},{id:"stacked-marker",type:"stacked",title:"Stacked Chart with Markers",description:"Referral source composition with trend markers",summary:"A stacked area chart with markers showing how your referral mix changes over time, highlighting shifts in patient acquisition patterns.",explanation:"This visualization combines stacked areas showing referral source composition with markers indicating key events or changes. Perfect for understanding how your referral mix evolves and identifying successful strategies.",icon:X.A,options:["Area Fill","Trend Markers","Cumulative View","Percentage Stack"]},{id:"stacked-column",type:"stacked-column",title:"Stacked Column Chart - Referral Sources",description:"Vertical stacked columns showing referral source breakdown",summary:"Stacked columns displaying referral source composition for different time periods or locations, making it easy to compare referral mix across segments.",explanation:"This chart stacks referral sources within columns representing different time periods or offices. Ideal for comparing how referral patterns differ between locations or change over time, helping identify best practices to replicate.",icon:ee.A,options:["By Time Period","By Office","100% Stack","Show Totals"]}];function ei(e){let{onSelectVisualization:s,isLoading:a=!1,trigger:r}=e,[l,n]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),{toast:o}=(0,ea.dj)();return(0,t.jsxs)(F,{open:d,onOpenChange:c,children:[(0,t.jsx)(T,{asChild:!0,children:r||(0,t.jsxs)(m.$,{size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(es.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Add Visualization"})]})}),(0,t.jsx)(O,{className:"max-w-4xl max-h-[90vh] overflow-hidden",children:(0,t.jsxs)("div",{className:"overflow-y-auto max-h-[80vh]",children:[(0,t.jsx)(L,{children:(0,t.jsx)($,{children:"Add Data Visualization"})}),a?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:Array.from({length:4}).map((e,s)=>(0,t.jsxs)(C.Zp,{children:[(0,t.jsxs)(C.aR,{children:[(0,t.jsx)(P,{className:"h-4 w-3/4"}),(0,t.jsx)(P,{className:"h-3 w-full"})]}),(0,t.jsx)(C.Wu,{children:(0,t.jsx)(P,{className:"h-20 w-full"})})]},s))}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:et.map(e=>{let a=e.icon;return(0,t.jsxs)(C.Zp,{className:"cursor-pointer hover:shadow-md transition-shadow border-2 hover:border-blue-200",onClick:()=>{n(e),s(e),c(!1),o({title:"Visualization Added",description:"".concat(e.title," has been added to your dashboard.")})},children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,t.jsx)(a,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(C.ZB,{className:"text-sm font-semibold",children:e.title}),(0,t.jsx)(C.BT,{className:"text-xs",children:e.description})]})]})}),(0,t.jsx)(C.Wu,{className:"pt-0",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Summary"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.summary})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Analysis"}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.explanation})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:"Options"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.options.map((e,s)=>(0,t.jsx)(k,{variant:"secondary",className:"text-xs",children:e},s))})]})]})})]},e.id)})}),!a&&0===et.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)("div",{className:"rounded-full bg-gray-100 p-3 mb-4",children:(0,t.jsx)(Q.A,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Visualizations Available"}),(0,t.jsx)("p",{className:"text-gray-500 max-w-sm",children:"There are no data visualizations available at the moment. Check back later for new options."})]})]})})]})}var er=a(98014),el=a(95316),en=a(38129);let ed=er.bL;er.YJ;let ec=er.WT,eo=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(er.l9,{ref:s,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[i,(0,t.jsx)(er.In,{asChild:!0,children:(0,t.jsx)(el.A,{className:"h-4 w-4 opacity-50"})})]})});eo.displayName=er.l9.displayName;let em=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(er.PP,{ref:s,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(en.A,{className:"h-4 w-4"})})});em.displayName=er.PP.displayName;let ex=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(er.wn,{ref:s,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(el.A,{className:"h-4 w-4"})})});ex.displayName=er.wn.displayName;let eh=i.forwardRef((e,s)=>{let{className:a,children:i,position:r="popper",...l}=e;return(0,t.jsx)(er.ZL,{children:(0,t.jsxs)(er.UC,{ref:s,className:(0,f.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...l,children:[(0,t.jsx)(em,{}),(0,t.jsx)(er.LM,{className:(0,f.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,t.jsx)(ex,{})]})})});eh.displayName=er.UC.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(er.JU,{ref:s,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...i})}).displayName=er.JU.displayName;let eu=i.forwardRef((e,s)=>{let{className:a,children:i,...r}=e;return(0,t.jsxs)(er.q7,{ref:s,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(er.VF,{children:(0,t.jsx)(u.A,{className:"h-4 w-4"})})}),(0,t.jsx)(er.p4,{children:i})]})});eu.displayName=er.q7.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(er.wv,{ref:s,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",a),...i})}).displayName=er.wv.displayName;var ep=a(44937),ef=a(21529);function ej(e){let{className:s,classNames:a,showOutsideDays:i=!0,...r}=e;return(0,t.jsx)(ef.hv,{showOutsideDays:i,className:(0,f.cn)("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,f.cn)((0,m.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,f.cn)((0,m.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100 cursor-pointer hover:bg-accent hover:text-accent-foreground"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:s,...a}=e;return(0,t.jsx)(ep.A,{className:(0,f.cn)("h-4 w-4",s),...a})},IconRight:e=>{let{className:s,...a}=e;return(0,t.jsx)(h.A,{className:(0,f.cn)("h-4 w-4",s),...a})}},...r})}ej.displayName="Calendar";var eg=a(84837);let ev=eg.bL,eN=eg.l9,ey=i.forwardRef((e,s)=>{let{className:a,align:i="center",sideOffset:r=4,...l}=e;return(0,t.jsx)(eg.ZL,{children:(0,t.jsx)(eg.UC,{ref:s,align:i,sideOffset:r,className:(0,f.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...l})})});function eb(e){let{date:s,onDateChange:a,placeholder:r="Pick a date",disabled:l=!1,className:n}=e,[d,c]=(0,i.useState)(!1);return(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)(ev,{open:d,onOpenChange:c,children:[(0,t.jsx)(eN,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"outline",className:(0,f.cn)("w-full justify-start text-left font-normal",!s&&"text-muted-foreground",n),disabled:l,"data-date-picker-trigger":!0,type:"button",onClick:e=>{console.log("Enhanced date picker trigger clicked"),c(!d)},children:[(0,t.jsx)(W.A,{className:"mr-2 h-4 w-4"}),s?(0,B.GP)(s,"PPP"):(0,t.jsx)("span",{children:r})]})}),(0,t.jsx)(ey,{className:"w-auto p-0",align:"start",side:"bottom",sideOffset:8,children:(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)(ej,{mode:"single",selected:s,onSelect:e=>{console.log("Enhanced date picker - date selected:",e),e&&(a(e),c(!1))},disabled:!1,captionLayout:"dropdown-buttons",fromYear:2020,toYear:2030,className:"rounded-md border-0"})})})]})})}ey.displayName=eg.UC.displayName;var ew=a(14099),eA=a(87082),eC=a(28043),eS=a(59878),eD=a(26805),ek=a(72792),eP=a(92287);let eR=["#1976D2","#00BCD4","#1d1d52"];function eI(e){let{data:s,title:a}=e,i=s.map(e=>({name:e.x,value:e.y,label:e.text}));return(0,t.jsxs)("div",{className:"w-full h-80",children:[a&&(0,t.jsx)("h3",{className:"text-center text-lg font-semibold mb-4",children:a}),(0,t.jsx)(eA.u,{width:"100%",height:"100%",children:(0,t.jsxs)(eC.r,{children:[(0,t.jsx)(eS.F,{data:i,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{label:s}=e;return s},outerRadius:100,fill:"#8884d8",dataKey:"value",children:i.map((e,s)=>(0,t.jsx)(eD.f,{fill:eR[s%eR.length]},"cell-".concat(s)))}),(0,t.jsx)(ek.m,{}),(0,t.jsx)(eP.s,{})]})})]})}var eF=a(2911),eT=a(68068),ez=a(88999),eE=a(47124),eO=a(23949);function eL(e){let{data:s,title:a}=e,i=s.map(e=>({name:e.x,Digital:e.digital,Professional:e.professional,Direct:e.direct}));return(0,t.jsxs)("div",{className:"w-full h-80",children:[a&&(0,t.jsx)("h3",{className:"text-center text-lg font-semibold mb-4",children:a}),(0,t.jsx)(eA.u,{width:"100%",height:"100%",children:(0,t.jsxs)(eF.E,{data:i,margin:{top:20,right:30,left:20,bottom:5},children:[(0,t.jsx)(eT.d,{strokeDasharray:"3 3"}),(0,t.jsx)(ez.W,{dataKey:"name"}),(0,t.jsx)(eE.h,{label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),(0,t.jsx)(ek.m,{formatter:e=>["".concat(e,"%"),""]}),(0,t.jsx)(eP.s,{}),(0,t.jsx)(eO.y,{dataKey:"Digital",fill:"#1976D2"}),(0,t.jsx)(eO.y,{dataKey:"Professional",fill:"#00BCD4"}),(0,t.jsx)(eO.y,{dataKey:"Direct",fill:"#1d1d52"})]})})]})}var e$=a(24898),eJ=a(9144);function eM(e){let{data:s,title:a}=e,i=s.map(e=>({name:e.x,Digital:e.digital,Professional:e.professional,Direct:e.direct}));return(0,t.jsxs)("div",{className:"w-full h-80",children:[a&&(0,t.jsx)("h3",{className:"text-center text-lg font-semibold mb-4",children:a}),(0,t.jsx)(eA.u,{width:"100%",height:"100%",children:(0,t.jsxs)(e$.b,{data:i,margin:{top:20,right:30,left:20,bottom:5},children:[(0,t.jsx)(eT.d,{strokeDasharray:"3 3"}),(0,t.jsx)(ez.W,{dataKey:"name"}),(0,t.jsx)(eE.h,{label:{value:"Percentage (%)",angle:-90,position:"insideLeft"}}),(0,t.jsx)(ek.m,{formatter:e=>["".concat(e,"%"),""]}),(0,t.jsx)(eP.s,{}),(0,t.jsx)(eJ.N,{type:"monotone",dataKey:"Digital",stroke:"#1976D2",strokeWidth:3,dot:{fill:"#1976D2",strokeWidth:2,r:4}}),(0,t.jsx)(eJ.N,{type:"monotone",dataKey:"Professional",stroke:"#00BCD4",strokeWidth:3,dot:{fill:"#00BCD4",strokeWidth:2,r:4}}),(0,t.jsx)(eJ.N,{type:"monotone",dataKey:"Direct",stroke:"#1d1d52",strokeWidth:3,dot:{fill:"#1d1d52",strokeWidth:2,r:4}})]})})]})}var e_=a(1955),eG=a(66042),eZ=a(9674),eU=a(41458);function eW(e){let{periodData:s,periodTitle:a}=e;if(!s)return(0,t.jsx)(C.Zp,{className:"h-64",children:(0,t.jsx)(C.Wu,{className:"flex items-center justify-center h-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2",children:"\uD83D\uDCCA"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No data available for summary"})]})})});let{avgNetProduction:i=0,avgAcquisitionCost:r=0,noShowRate:l=0,referralSources:n={digital:0,professional:0,direct:0},conversionRates:d={digital:0,professional:0,direct:0}}=s;n.digital,n.professional,n.direct;let c=Object.entries(n).reduce((e,s)=>n[e[0]]>n[s[0]]?e:s)[0],o=(d.digital+d.professional+d.direct)/3,m=i>0&&r>0?(i-r)/r*100:0;return(0,t.jsxs)(C.Zp,{children:[(0,t.jsxs)(C.aR,{className:"pb-3",children:[(0,t.jsxs)(C.ZB,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(e_.A,{className:"h-4 w-4 text-blue-600"}),a," Summary"]}),(0,t.jsx)(C.BT,{children:"Key performance metrics overview"})]}),(0,t.jsxs)(C.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(eG.A,{className:"h-4 w-4 text-green-600"}),(0,t.jsx)("span",{className:"text-xs font-medium text-green-700",children:"Net Production"})]}),(0,t.jsxs)("div",{className:"text-lg font-semibold text-green-800",children:["$",i.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)(eZ.A,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-xs font-medium text-blue-700",children:"Acquisition Cost"})]}),(0,t.jsxs)("div",{className:"text-lg font-semibold text-blue-800",children:["$",r.toLocaleString()]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"ROI"}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[m>0?(0,t.jsx)(X.A,{className:"h-4 w-4 text-green-600"}):(0,t.jsx)(eU.A,{className:"h-4 w-4 text-red-600"}),(0,t.jsxs)("span",{className:"font-semibold ".concat(m>0?"text-green-600":"text-red-600"),children:[m.toFixed(1),"%"]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Avg Conversion Rate"}),(0,t.jsxs)("span",{className:"font-semibold text-blue-600",children:[o.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"No-Show Rate"}),(0,t.jsxs)("span",{className:"font-semibold ".concat(l>20?"text-red-600":"text-yellow-600"),children:[l.toFixed(1),"%"]})]})]}),(0,t.jsxs)("div",{className:"border-t pt-3",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-gray-600 mb-2",children:"Top Referral Source"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(k,{variant:"secondary",className:"capitalize",children:c}),(0,t.jsxs)("span",{className:"text-sm font-semibold",children:[n[c],"% of referrals"]})]})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 border-t pt-2",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(W.A,{className:"h-3 w-3"}),"Live data from Greyfinch API"]})})]})]})}var eB=a(58618),eq=a(79890),eV=a(75725),eH=a(25104);function eK(e){let{period:s,query:a,locations:i,onUpdatePeriod:r,onAddPeriod:l,isFirstPeriod:n=!1,isCompact:d=!1}=e,c=null==a?void 0:a.data,o=null==a?void 0:a.isLoading,x=null==a?void 0:a.error;if(console.log("PeriodColumn ".concat(s.id," - isLoading: ").concat(o,", hasData: ").concat(!!c,", error: ").concat(!!x)),console.log("Period dates: start=".concat(s.startDate,", end=").concat(s.endDate)),o)return(0,t.jsxs)(C.Zp,{className:d?"h-auto":"h-[500px]",children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(C.ZB,{className:"text-lg",children:s.title})})}),(0,t.jsx)(C.Wu,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading live data from Greyfinch API..."})]})})})]});if(x)return(0,t.jsxs)(C.Zp,{className:d?"h-auto":"h-[500px]",children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)(C.ZB,{className:"text-lg text-red-600",children:s.title})})}),(0,t.jsx)(C.Wu,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-red-500 mb-4",children:"⚠️"}),(0,t.jsx)("p",{className:"text-red-600 font-medium",children:"Failed to load data"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mt-2",children:x.message}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Check your Greyfinch API connection"})]})})})]});let h=c||{avgNetProduction:0,avgAcquisitionCost:0,noShowRate:0,referralSources:{digital:0,professional:0,direct:0},conversionRates:{digital:0,professional:0,direct:0},trends:{weekly:[]}},u=[{x:"Digital",y:h.referralSources.digital,text:"".concat(h.referralSources.digital,"%")},{x:"Professional",y:h.referralSources.professional,text:"".concat(h.referralSources.professional,"%")},{x:"Direct",y:h.referralSources.direct,text:"".concat(h.referralSources.direct,"%")}],p=[{x:"Digital",digital:h.conversionRates.digital,professional:0,direct:0},{x:"Professional",digital:0,professional:h.conversionRates.professional,direct:0},{x:"Direct",digital:0,professional:0,direct:h.conversionRates.direct}],f=h.trends.weekly.map(e=>({x:e.week,digital:e.digital,professional:e.professional,direct:e.direct}));return s.startDate&&s.endDate?d?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Net Production"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:["$",h.avgNetProduction.toLocaleString()]})]}),(0,t.jsx)(eG.A,{className:"h-8 w-8 text-[#1d1d52]"})]})}),(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"No-Show Rate"}),(0,t.jsxs)("p",{className:"text-lg font-semibold",children:[h.noShowRate,"%"]})]}),(0,t.jsx)(eV.A,{className:"h-8 w-8 text-red-500"})]})})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Referral Sources"}),(0,t.jsx)(eI,{data:u})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Conversion Rates"}),(0,t.jsx)(eL,{data:p})]})]})]}):(0,t.jsxs)(C.Zp,{className:"h-full",children:[(0,t.jsxs)(C.aR,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(C.ZB,{className:"text-lg font-semibold",children:s.title}),(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{let e=prompt("Enter new period name:",s.title);e&&e.trim()&&r(s.id,{title:e.trim()})},children:(0,t.jsx)(eB.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-xs text-gray-600",children:"Location"}),(0,t.jsxs)(ed,{value:s.locationId,onValueChange:e=>r(s.id,{locationId:e}),children:[(0,t.jsx)(eo,{className:"h-8",children:(0,t.jsx)(ec,{})}),(0,t.jsxs)(eh,{children:[(0,t.jsx)(eu,{value:"all",children:"All Locations"}),i.map(e=>(0,t.jsx)(eu,{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-xs text-gray-600",children:"Start Date"}),(0,t.jsx)(eb,{date:s.startDate,onDateChange:e=>r(s.id,{startDate:e}),className:"h-8",placeholder:"Select start"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-xs text-gray-600",children:"End Date"}),(0,t.jsx)(eb,{date:s.endDate,onDateChange:e=>r(s.id,{endDate:e}),className:"h-8",placeholder:"Select end"})]})]})]})})]}),(0,t.jsx)(C.Wu,{className:"space-y-6",children:o?(0,t.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Avg Net Production"}),(0,t.jsxs)("p",{className:"text-xl font-bold",children:["$",h.avgNetProduction.toLocaleString()]})]}),(0,t.jsx)(eG.A,{className:"h-8 w-8 text-[#1d1d52]"})]})}),(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"Acquisition Cost"}),(0,t.jsxs)("p",{className:"text-xl font-bold",children:["$",h.avgAcquisitionCost]})]}),(0,t.jsx)(eH.A,{className:"h-8 w-8 text-green-500"})]})}),(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg col-span-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-600",children:"No-Show Rate"}),(0,t.jsxs)("p",{className:"text-xl font-bold",children:[h.noShowRate,"%"]})]}),(0,t.jsx)(eV.A,{className:"h-8 w-8 text-red-500"})]})})]}),(0,t.jsx)(eW,{periodData:h,periodTitle:s.title}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Referral Sources"}),(0,t.jsx)(eI,{data:u})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Conversion Rates"}),(0,t.jsx)(eL,{data:p})]}),h.trends.weekly.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-3",children:"Weekly Trends"}),(0,t.jsx)(eM,{data:f})]})]})]})})]}):(0,t.jsxs)(C.Zp,{className:"w-full min-w-[350px] overflow-hidden",children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(C.ZB,{className:"text-lg",children:s.title}),(0,t.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>{console.log("Period edit clicked for:",s.id)},children:(0,t.jsx)(eB.A,{className:"h-4 w-4"})})]})}),(0,t.jsxs)(C.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(ew.J,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),"Select Date Range"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,t.jsx)(eb,{date:s.startDate,onDateChange:e=>{console.log("Start date changed:",e),r(s.id,{startDate:e})},placeholder:"Start date"}),(0,t.jsx)(eb,{date:s.endDate,onDateChange:e=>{console.log("End date changed:",e),r(s.id,{endDate:e})},placeholder:"End date"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(ew.J,{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(eq.A,{className:"h-4 w-4"}),"Location"]}),(0,t.jsxs)(ed,{value:s.locationId,onValueChange:e=>r(s.id,{locationId:e}),children:[(0,t.jsx)(eo,{children:(0,t.jsx)(ec,{placeholder:"Select location"})}),(0,t.jsxs)(eh,{children:[(0,t.jsx)(eu,{value:"all",children:"All Locations"}),i.map(e=>(0,t.jsx)(eu,{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(W.A,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,t.jsx)("p",{className:"text-sm mb-4",children:"Select a date range to view analytics data"}),n&&l&&(0,t.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 mb-3",children:"Need to compare multiple periods?"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-xs text-gray-500",children:'Use the "Add Column" button at the top to add comparison periods'}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 text-xs text-blue-600 bg-blue-50 px-3 py-2 rounded-lg",children:[(0,t.jsx)(es.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Look for the + button above"})]})})]})]})]})]})]})}var eY=a(26625);function eQ(e){let{locations:s,onAddPeriod:a,existingPeriodsCount:r,children:l}=e,[n,d]=(0,i.useState)(!1),[c,o]=(0,i.useState)("Period ".concat(String.fromCharCode(65+r))),[x,h]=(0,i.useState)("all"),[u,p]=(0,i.useState)(new Date),[f,j]=(0,i.useState)(()=>{let e=new Date,s=new Date(e);return s.setMonth(e.getMonth()+1),s});return(0,t.jsxs)(F,{open:n,onOpenChange:d,children:[(0,t.jsx)(T,{asChild:!0,children:l||(0,t.jsx)("div",{className:"w-80 h-full min-h-[600px] border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center bg-gray-50/50 hover:bg-gray-100/50 transition-colors cursor-pointer group",children:(0,t.jsxs)("div",{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-[#1d1d52] flex items-center justify-center mx-auto group-hover:bg-[#1d1d52]/80 transition-colors",children:(0,t.jsx)(es.A,{className:"w-8 h-8 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Add Analysis Period"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 max-w-48",children:"Compare data across different time periods and locations for comprehensive insights"})]}),(0,t.jsxs)(m.$,{variant:"outline",className:"mt-4",children:[(0,t.jsx)(es.A,{className:"w-4 h-4 mr-2"}),"Add Column"]})]})})}),(0,t.jsxs)(O,{className:"sm:max-w-md",onInteractOutside:e=>{let s=e.target;if(s.closest("[data-date-picker-trigger]")||s.closest(".rdp")||s.closest(".rdp-day")||s.closest(".rdp-nav")||s.closest(".rdp-dropdown")||s.closest('[role="dialog"]')||s.closest(".calendar"))return void e.preventDefault()},onPointerDownOutside:e=>{let s=e.target;(s.closest("[data-date-picker-trigger]")||s.closest(".rdp")||s.closest(".rdp-day")||s.closest(".rdp-nav")||s.closest(".rdp-dropdown")||s.closest(".calendar"))&&e.preventDefault()},children:[(0,t.jsx)(L,{children:(0,t.jsxs)($,{className:"flex items-center gap-2",children:[(0,t.jsx)(es.A,{className:"w-5 h-5 text-[#1d1d52]"}),"Add Analysis Period"]})}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ew.J,{htmlFor:"period-title",children:"Period Name"}),(0,t.jsx)(eY.p,{id:"period-title",value:c,onChange:e=>o(e.target.value),placeholder:"e.g., Q1 2024, Summer Campaign"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(ew.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(eq.A,{className:"w-4 h-4"}),"Location"]}),(0,t.jsxs)(ed,{value:x,onValueChange:h,children:[(0,t.jsx)(eo,{children:(0,t.jsx)(ec,{})}),(0,t.jsxs)(eh,{children:[(0,t.jsx)(eu,{value:"all",children:"All Locations"}),s.map(e=>(0,t.jsx)(eu,{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(ew.J,{className:"flex items-center gap-2",children:[(0,t.jsx)(W.A,{className:"w-4 h-4"}),"Start Date"]}),(0,t.jsx)(eb,{date:u,onDateChange:p,placeholder:"Select start date"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ew.J,{children:"End Date"}),(0,t.jsx)(eb,{date:f,onDateChange:j,placeholder:"Select end date"})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,t.jsx)(m.$,{variant:"outline",onClick:()=>d(!1),className:"flex-1",children:"Cancel"}),(0,t.jsx)(m.$,{onClick:()=>{if(console.log("handleAddPeriod called with:",{startDate:u,endDate:f,title:c,locationId:x}),!u||!f){console.error("Missing dates:",{startDate:u,endDate:f}),alert("Please select both start and end dates");return}if(r>=10){console.error("Maximum 10 periods allowed"),alert("Maximum 10 periods allowed");return}let e={name:c,title:c,locationId:x,startDate:u,endDate:f};console.log("Adding period with data:",e);try{a(e),console.log("Period added successfully");let s=String.fromCharCode(65+r+1);o("Period ".concat(s)),h("all"),p(new Date);let t=new Date;t.setMonth(t.getMonth()+1),j(t),d(!1)}catch(s){console.error("Error adding period:",s);let e=s instanceof Error?s.message:"Unknown error occurred";alert("Error adding period: ".concat(e))}},className:"flex-1 bg-[#1d1d52] hover:bg-[#1d1d52]/90",disabled:!u||!f||!c.trim(),children:"Add Period"})]})]})]})}var eX=a(1815);function e0(e){let{periods:s,locations:a,periodQueries:r,onAddPeriod:l,onRemovePeriod:n,onUpdatePeriod:d}=e,c=(0,i.useRef)(null),[o,x]=(0,i.useState)(new Set);return(0,i.useEffect)(()=>{c.current&&c.current.scrollTo({left:c.current.scrollWidth,behavior:"smooth"})},[s.length]),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"lg:hidden mb-4",children:(0,t.jsxs)(C.Zp,{children:[(0,t.jsx)(C.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(C.ZB,{className:"text-sm font-medium",children:["Analytics Periods (",s.length,")"]}),(0,t.jsx)(eQ,{locations:a,onAddPeriod:l,existingPeriodsCount:s.length,children:(0,t.jsx)(m.$,{size:"sm",className:"h-8 px-3",children:(0,t.jsx)(es.A,{className:"h-4 w-4"})})})]})}),(0,t.jsx)(C.Wu,{children:(0,t.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-2",children:s.map((e,s)=>(a.find(s=>s.id.toString()===e.locationId),(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(k,{variant:0===s?"default":"secondary",className:"cursor-pointer text-xs px-2 py-1",onClick:()=>{let s=document.getElementById("period-".concat(e.id));s&&s.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})},children:e.title})},e.id)))})})]})}),(0,t.jsxs)("div",{ref:c,className:"flex gap-6 overflow-x-auto pb-4 snap-x snap-mandatory",style:{scrollbarWidth:"none",msOverflowStyle:"none",height:"calc(100vh - 300px)",minHeight:"600px"},children:[s.map((e,i)=>{var c,h;let u=r[i],p=a.find(s=>s.id.toString()===e.locationId);return(0,t.jsx)("div",{id:"period-".concat(e.id),className:"flex-shrink-0 snap-center overflow-hidden",style:{width:"calc(100vw - 2rem)",maxWidth:"420px",height:"100%"},children:(0,t.jsxs)(C.Zp,{className:"h-full border-2 transition-all duration-200 hover:shadow-lg",children:[(0,t.jsxs)(C.aR,{className:"pb-4 space-y-0 sticky top-0 bg-white z-10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 ".concat(o.has(e.id)?"text-orange-600 bg-orange-50":"text-gray-500 hover:text-[#1d1d52] hover:bg-gray-100"),onClick:()=>{let s=new Set(o);o.has(e.id)?s.delete(e.id):s.add(e.id),x(s)},children:(0,t.jsx)(eB.A,{className:"h-4 w-4"})}),(0,t.jsx)(C.ZB,{className:"text-lg font-semibold",children:e.title})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ei,{onSelectVisualization:s=>{let a=e.visualizations||[];d(e.id,{visualizations:[...a,s]})},trigger:(0,t.jsx)(m.$,{size:"sm",className:"h-8 w-8 p-0 bg-blue-600 hover:bg-blue-700 rounded-lg",children:(0,t.jsx)(es.A,{className:"h-4 w-4 text-white"})})}),s.length>1&&(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>n(e.id),children:(0,t.jsx)(I.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.startDate&&e.endDate?"".concat((0,B.GP)(new Date(e.startDate),"MMM d")," - ").concat((0,B.GP)(new Date(e.endDate),"MMM d, yyyy")):"Select date range"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)(eq.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==p?void 0:p.name)||"All Locations"})]})]})]}),(0,t.jsxs)(C.Wu,{className:"pt-0 space-y-4 overflow-y-auto",style:{maxHeight:"calc(100vh - 350px)"},children:[(0,t.jsx)(eK,{period:e,query:u,locations:a,onUpdatePeriod:d,onAddPeriod:l,isFirstPeriod:0===i,isCompact:!0}),null==(c=e.visualizations)?void 0:c.map((s,a)=>(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-medium",children:s.title}),o.has(e.id)&&(0,t.jsx)(m.$,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-500 hover:text-red-700",onClick:()=>{var s;let t=(null==(s=e.visualizations)?void 0:s.filter((e,s)=>s!==a))||[];d(e.id,{visualizations:t})},children:(0,t.jsx)(I.A,{className:"h-4 w-4"})})]}),o.has(e.id)?(0,t.jsx)("p",{className:"text-sm text-gray-600",children:s.description}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:s.description}),(0,t.jsxs)("div",{className:"h-48 bg-gray-100 rounded-lg flex items-center justify-center text-sm text-gray-500",children:[s.title," Chart Loading..."]})]})]},"".concat(e.id,"-").concat(s.id,"-").concat(a))),((null==(h=e.visualizations)?void 0:h.length)||0)>0&&(0,t.jsx)("div",{className:"mt-4 flex gap-2",children:(0,t.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>{let s=prompt("Enter template name:","".concat(e.title," Template"));if(s&&s.trim()){let a=JSON.parse(localStorage.getItem("orthodash-templates")||"[]"),t={id:Date.now(),name:s.trim(),period:{title:e.title,locationId:e.locationId,visualizations:e.visualizations},createdAt:new Date().toISOString()};a.push(t),localStorage.setItem("orthodash-templates",JSON.stringify(a)),alert('Template "'.concat(s,'" saved successfully!'))}},className:"flex items-center gap-2",children:[(0,t.jsx)(eX.A,{className:"h-4 w-4"}),"Save as Template"]})})]})]})},e.id)}),(0,t.jsx)("div",{className:"flex-shrink-0 snap-center sticky-add-column",style:{width:"calc(100vw - 2rem)",maxWidth:"420px",height:"100%"},children:(0,t.jsx)(eQ,{locations:a,onAddPeriod:l,existingPeriodsCount:s.length})})]}),(0,t.jsx)("div",{className:"lg:hidden mt-4 flex justify-center",children:(0,t.jsx)("div",{className:"flex gap-2",children:Array.from({length:s.length+1}).map((e,s)=>(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-300 transition-colors"},s))})})]})}let e4=R.bL,e2=R.l9;R.bm;let e1=R.ZL,e5=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.hJ,{className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i,ref:s})});e5.displayName=R.hJ.displayName;let e3=(0,S.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),e6=i.forwardRef((e,s)=>{let{side:a="right",className:i,children:r,...l}=e;return(0,t.jsxs)(e1,{children:[(0,t.jsx)(e5,{}),(0,t.jsxs)(R.UC,{ref:s,className:(0,f.cn)(e3({side:a}),i),...l,children:[r,(0,t.jsxs)(R.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,t.jsx)(I.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});e6.displayName=R.UC.displayName;let e8=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};e8.displayName="SheetHeader";let e9=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.hE,{ref:s,className:(0,f.cn)("text-lg font-semibold text-foreground",a),...i})});e9.displayName=R.hE.displayName;let e7=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(R.VY,{ref:s,className:(0,f.cn)("text-sm text-muted-foreground",a),...i})});e7.displayName=R.VY.displayName;var se=a(52669);let ss=se.bL,sa=se.R6,st=se.Ke;var si=a(19878),sr=a(2522),sl=a(89903),sn=a(59452),sd=a(35711);function sc(e){var s;let{onDataSelected:a,trigger:r}=e,[l,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)([]),[o,x]=(0,i.useState)(null),{toast:h}=(0,ea.dj)(),u=async()=>{n(!0);try{let e=await fetch("/api/locations"),s=await e.json();c(s)}catch(e){h({title:"Error",description:"Failed to fetch locations",variant:"destructive"})}finally{n(!1)}};return(0,t.jsxs)(C.Zp,{className:"w-full",children:[(0,t.jsxs)(C.aR,{children:[(0,t.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(eq.A,{className:"h-5 w-5"}),"Practice Locations"]}),(0,t.jsx)(C.BT,{children:"Select a practice location to view analytics data"})]}),(0,t.jsxs)(C.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(sd.A,{className:"h-4 w-4 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Available Locations"})]}),(0,t.jsx)(m.$,{onClick:()=>{u()},disabled:l,variant:"outline",size:"sm",children:(0,t.jsx)(si.A,{className:"h-4 w-4 ".concat(l?"animate-spin":"")})})]}),l?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)(si.A,{className:"h-6 w-6 animate-spin mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Loading locations..."})]}):d.length>0?(0,t.jsx)("div",{className:"grid gap-2",children:d.map(e=>(0,t.jsx)(m.$,{onClick:()=>{var s;x(s=e.id.toString()),a&&a({locationId:s,type:"location"})},variant:o===e.id.toString()?"default":"outline",className:"justify-start",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eq.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.name}),e.patientCount&&(0,t.jsxs)(k,{variant:"secondary",className:"ml-auto",children:[e.patientCount," patients"]})]})},e.id))}):(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"No locations found"}),(0,t.jsx)(m.$,{onClick:u,variant:"outline",size:"sm",className:"mt-2",children:"Load Locations"})]}),o&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-green-800",children:["Selected: ",null==(s=d.find(e=>e.id.toString()===o))?void 0:s.name]})})]})]})}var so=a(49240),sm=a(41001),sx=a(8584);function sh(){let[e,s]=(0,i.useState)(""),[a,r]=(0,i.useState)(""),[l,n]=(0,i.useState)(!1),[d,c]=(0,i.useState)(!1),{toast:o}=(0,ea.dj)(),x=async()=>{if(!e||!a)return void o({title:"Missing Credentials",description:"Please enter both API key and secret.",variant:"destructive"});n(!0);try{let s=await fetch("/api/greyfinch/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:e,apiSecret:a})}),t=await s.json();t.success?(c(!0),o({title:"Success",description:"Greyfinch API connected successfully!"})):o({title:"Connection Failed",description:t.message||"Failed to connect to Greyfinch API",variant:"destructive"})}catch(e){o({title:"Error",description:"Failed to setup Greyfinch API connection",variant:"destructive"})}finally{n(!1)}},h=async()=>{n(!0);try{let e=await fetch("/api/greyfinch/test"),s=await e.json();s.success?(c(!0),o({title:"Connection Test",description:"Greyfinch API connection is working!"})):(c(!1),o({title:"Connection Test Failed",description:s.message||"Failed to connect to Greyfinch API",variant:"destructive"}))}catch(e){c(!1),o({title:"Connection Test Failed",description:"Failed to test Greyfinch API connection",variant:"destructive"})}finally{n(!1)}};return(0,t.jsxs)(C.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(C.aR,{children:[(0,t.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(sl.A,{className:"h-5 w-5"}),"Greyfinch API Setup"]}),(0,t.jsx)(C.BT,{children:"Configure your Greyfinch API credentials to enable live data integration"})]}),(0,t.jsxs)(C.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ew.J,{htmlFor:"api-key",children:"API Key"}),(0,t.jsx)(eY.p,{id:"api-key",type:"password",placeholder:"Enter your Greyfinch API key",value:e,onChange:e=>s(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ew.J,{htmlFor:"api-secret",children:"API Secret"}),(0,t.jsx)(eY.p,{id:"api-secret",type:"password",placeholder:"Enter your Greyfinch API secret",value:a,onChange:e=>r(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m.$,{onClick:x,disabled:l,className:"flex-1",children:l?"Setting up...":"Setup API"}),(0,t.jsx)(m.$,{onClick:h,disabled:l,variant:"outline",children:"Test"})]}),d&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,t.jsx)(so.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"Connected to Greyfinch API"})]}),!d&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-amber-600",children:[(0,t.jsx)(sm.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-sm",children:"Not connected to Greyfinch API"})]}),(0,t.jsx)("div",{className:"pt-2 border-t",children:(0,t.jsxs)(m.$,{variant:"link",size:"sm",className:"p-0 h-auto",children:[(0,t.jsx)(sx.A,{className:"h-4 w-4 mr-1"}),"Get Greyfinch API credentials"]})})]})]})}let su=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...i})});su.displayName="Textarea";var sp=a(31334);let sf=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(sp.bL,{ref:s,className:(0,f.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...i,children:(0,t.jsx)(sp.C1,{className:(0,f.cn)("flex items-center justify-center text-current"),children:(0,t.jsx)(u.A,{className:"h-4 w-4"})})})});sf.displayName=sp.bL.displayName;var sj=a(18500);function sg(e){let{reportData:s,reportName:a="ORTHODASH Report",trigger:r}=e,[l,n]=(0,i.useState)({title:a,description:"",includeCharts:!0,includeData:!0,includeSummary:!0,pageFormat:"A4",orientation:"portrait"}),{toast:d}=(0,ea.dj)(),c=(0,A.n)({mutationFn:async e=>(await V("POST","/api/export/pdf",{reportData:s,options:e})).blob(),onSuccess:e=>{let s=window.URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="".concat(l.title.replace(/[^a-z0-9]/gi,"_").toLowerCase(),".pdf"),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a),d({title:"PDF Generated",description:"Your report has been downloaded successfully."})},onError:e=>{d({title:"Export Failed",description:e instanceof Error?e.message:"Failed to generate PDF",variant:"destructive"})}}),o=(0,t.jsxs)(m.$,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(Z.A,{className:"h-4 w-4"}),"Export PDF"]});return(0,t.jsxs)(F,{children:[(0,t.jsx)(T,{asChild:!0,children:r||o}),(0,t.jsxs)(O,{className:"max-w-lg mt-8 max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(L,{children:(0,t.jsxs)($,{className:"flex items-center gap-2",children:[(0,t.jsx)(G.A,{className:"h-5 w-5"}),"Export to PDF"]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"title",children:"Report Title"}),(0,t.jsx)(eY.p,{id:"title",value:l.title,onChange:e=>n(s=>({...s,title:e.target.value})),placeholder:"Enter report title"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"description",children:"Description (Optional)"}),(0,t.jsx)(su,{id:"description",value:l.description,onChange:e=>n(s=>({...s,description:e.target.value})),placeholder:"Add a description for your report",rows:3})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(ew.J,{className:"text-sm font-medium",children:"Include in PDF"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(sf,{id:"charts",checked:l.includeCharts,onCheckedChange:e=>n(s=>({...s,includeCharts:!!e}))}),(0,t.jsx)(ew.J,{htmlFor:"charts",className:"text-sm",children:"Charts and Visualizations"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(sf,{id:"data",checked:l.includeData,onCheckedChange:e=>n(s=>({...s,includeData:!!e}))}),(0,t.jsx)(ew.J,{htmlFor:"data",className:"text-sm",children:"Raw Data Tables"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(sf,{id:"summary",checked:l.includeSummary,onCheckedChange:e=>n(s=>({...s,includeSummary:!!e}))}),(0,t.jsx)(ew.J,{htmlFor:"summary",className:"text-sm",children:"AI Summary & Insights"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(ew.J,{className:"text-sm font-medium",children:"PDF Format"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-xs text-gray-600",children:"Page Size"}),(0,t.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,t.jsx)(m.$,{variant:"A4"===l.pageFormat?"default":"outline",size:"sm",onClick:()=>n(e=>({...e,pageFormat:"A4"})),children:"A4"}),(0,t.jsx)(m.$,{variant:"Letter"===l.pageFormat?"default":"outline",size:"sm",onClick:()=>n(e=>({...e,pageFormat:"Letter"})),children:"Letter"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-xs text-gray-600",children:"Orientation"}),(0,t.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,t.jsx)(m.$,{variant:"portrait"===l.orientation?"default":"outline",size:"sm",onClick:()=>n(e=>({...e,orientation:"portrait"})),children:"Portrait"}),(0,t.jsx)(m.$,{variant:"landscape"===l.orientation?"default":"outline",size:"sm",onClick:()=>n(e=>({...e,orientation:"landscape"})),children:"Landscape"})]})]})]})]}),(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(G.A,{className:"h-4 w-4 text-blue-600 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-blue-900",children:"Preview"}),(0,t.jsxs)("p",{className:"text-blue-800 mt-1",children:[l.pageFormat," ",l.orientation," format with"," ",[l.includeCharts&&"charts",l.includeData&&"data",l.includeSummary&&"summary"].filter(Boolean).join(", ")]})]})]})}),(0,t.jsx)(m.$,{onClick:()=>{c.mutate(l)},disabled:c.isPending||!l.title.trim(),className:"w-full",children:c.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(sj.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating PDF..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"Download PDF"]})})]})]})]})}var sv=a(76924);let sN=i.forwardRef((e,s)=>{let{className:a,orientation:i="horizontal",decorative:r=!0,...l}=e;return(0,t.jsx)(sv.b,{ref:s,decorative:r,orientation:i,className:(0,f.cn)("shrink-0 bg-border","horizontal"===i?"h-[1px] w-full":"h-full w-[1px]",a),...l})});sN.displayName=sv.b.displayName;var sy=a(22319),sb=a(99762),sw=a(57009);function sA(e){var s,a,r,l;let{reportData:n,trigger:d}=e,[c,o]=(0,i.useState)("link"),[x,h]=(0,i.useState)("ORTHODASH Analytics Report"),[u,p]=(0,i.useState)("Check out this analytics report from ORTHODASH"),[f,j]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),{toast:N}=(0,ea.dj)(),[y,b]=(0,i.useState)(!1),[w,A]=(0,i.useState)(null),C="".concat(window.location.origin,"/shared/").concat(btoa(JSON.stringify({title:x,timestamp:Date.now(),periods:(null==n||null==(s=n.periods)?void 0:s.length)||0,id:(null==n?void 0:n.timestamp)||Date.now()}))),S=async()=>{var e;if(!n||!(null==(e=n.periods)?void 0:e.length))return void N({title:"Need More Data",description:"Please add another period or generate a summary before creating a PDF report.",variant:"default"});if(!n.periods.some(e=>e.startDate&&e.endDate))return void N({title:"Add Date Ranges",description:"Please configure date ranges for your periods to generate a comprehensive report.",variant:"default"});b(!0);try{let e=await fetch("/api/export/pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reportData:n,options:{title:x,description:u,includeCharts:!0,includeData:!0,includeSummary:!0,pageFormat:"A4",orientation:"portrait"}})});if(!e.ok)throw Error("PDF generation failed");let s=await e.blob(),a=window.URL.createObjectURL(s);A(a),N({title:"PDF Generated",description:"Report PDF is ready for sharing."})}catch(e){N({title:"Export Unavailable",description:"Please add more data or configure comparative analysis to enable PDF export.",variant:"default"})}finally{b(!1)}},D=async()=>{try{await navigator.clipboard.writeText(C),v(!0),N({title:"Link Copied",description:"Shareable link has been copied to clipboard."}),setTimeout(()=>v(!1),2e3)}catch(e){N({title:"Copy Failed",description:"Unable to copy link. Please try again.",variant:"destructive"})}},k=(0,t.jsxs)(m.$,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(sr.A,{className:"h-4 w-4"}),"Share"]});return(0,t.jsxs)(F,{children:[(0,t.jsx)(T,{asChild:!0,children:d||k}),(0,t.jsxs)(O,{className:"max-w-md",children:[(0,t.jsx)(L,{children:(0,t.jsxs)($,{className:"flex items-center gap-2",children:[(0,t.jsx)(sr.A,{className:"h-5 w-5"}),"Share Report"]})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(W.A,{className:"h-4 w-4 text-gray-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Report Summary"})]}),(0,t.jsxs)("div",{className:"space-y-1 text-xs text-gray-600",children:[(0,t.jsxs)("div",{children:["Title: ",(null==n?void 0:n.title)||"ORTHODASH Analytics Report"]}),(0,t.jsxs)("div",{children:["Periods: ",(null==n||null==(a=n.periods)?void 0:a.length)||0]}),(0,t.jsxs)("div",{children:["Generated: ",new Date().toLocaleDateString()]}),(null==n||null==(r=n.summary)?void 0:r.dateRange)&&(0,t.jsxs)("div",{children:["Date Range: ",n.summary.dateRange]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("h3",{className:"text-sm font-medium",children:"Generate PDF Report"})}),(0,t.jsx)(m.$,{onClick:S,disabled:y||!(null==n||null==(l=n.periods)?void 0:l.length),className:"w-full",variant:"outline",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Generating PDF..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(sr.A,{className:"h-4 w-4 mr-2"}),"Generate Shareable PDF"]})}),w&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m.$,{onClick:()=>{if(w){let e=document.createElement("a");e.href=w,e.download="".concat(x.replace(/\s+/g,"-").toLowerCase(),".pdf"),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},variant:"outline",size:"sm",className:"flex-1",children:[(0,t.jsx)(Z.A,{className:"h-4 w-4 mr-2"}),"Download"]}),(0,t.jsxs)(m.$,{onClick:()=>{"".concat(C,"&pdf=").concat(encodeURIComponent(w)),D()},variant:"outline",size:"sm",className:"flex-1",children:[g?(0,t.jsx)(so.A,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(sy.A,{className:"h-4 w-4 mr-2"}),"Copy PDF Link"]})]})]}),(0,t.jsx)(sN,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{className:"text-sm font-medium mb-3 block",children:"Share Method"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)(m.$,{variant:"link"===c?"default":"outline",size:"sm",onClick:()=>o("link"),className:"flex items-center gap-2",children:[(0,t.jsx)(sb.A,{className:"h-4 w-4"}),"Share Link"]}),(0,t.jsxs)(m.$,{variant:"email"===c?"default":"outline",size:"sm",onClick:()=>o("email"),className:"flex items-center gap-2",children:[(0,t.jsx)(sw.A,{className:"h-4 w-4"}),"Email"]})]})]}),(0,t.jsx)(sN,{}),"link"===c&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"share-title",children:"Report Title"}),(0,t.jsx)(eY.p,{id:"share-title",value:x,onChange:e=>h(e.target.value),placeholder:"Enter report title"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"share-link",children:"Shareable Link"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(eY.p,{id:"share-link",value:C,readOnly:!0,className:"text-sm"}),(0,t.jsx)(m.$,{onClick:D,size:"sm",variant:"outline",className:"px-3",children:g?(0,t.jsx)(so.A,{className:"h-4 w-4 text-green-600"}):(0,t.jsx)(sy.A,{className:"h-4 w-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"This link allows view-only access to your analytics report"})]})]}),"email"===c&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"email-recipients",children:"Recipients"}),(0,t.jsx)(eY.p,{id:"email-recipients",type:"email",multiple:!0,value:f,onChange:e=>j(e.target.value),placeholder:"colleague@teamorthodontics.com"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Separate multiple emails with commas"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"email-subject",children:"Subject"}),(0,t.jsx)(eY.p,{id:"email-subject",value:x,onChange:e=>h(e.target.value),placeholder:"Email subject"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"email-message",children:"Message"}),(0,t.jsx)(su,{id:"email-message",value:u,onChange:e=>p(e.target.value),placeholder:"Add a personal message",rows:3})]}),(0,t.jsxs)(m.$,{onClick:()=>{let e=encodeURIComponent(x),s=encodeURIComponent("".concat(u,"\n\nView the report: ").concat(C)),a="mailto:".concat(f,"?subject=").concat(e,"&body=").concat(s);window.open(a),N({title:"Email Draft Created",description:"Your default email client should open with the report link."})},disabled:!f.trim(),className:"w-full",children:[(0,t.jsx)(sw.A,{className:"mr-2 h-4 w-4"}),"Create Email"]})]}),(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(eZ.A,{className:"h-4 w-4 text-blue-600 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-blue-900",children:"Secure Sharing"}),(0,t.jsx)("p",{className:"text-blue-800 mt-1",children:"Shared reports are view-only and expire after 30 days. Recipients cannot edit or download raw data."})]})]})})]})]})]})}function sC(e){let{periods:s,locations:a,onAddPeriod:r,onClearData:l,onExport:n,onShare:d,onGreyfinchDataSelected:c}=e,[o,x]=(0,i.useState)(!1),[h,u]=(0,i.useState)(!1),[p,f]=(0,i.useState)(!1),{toast:j}=(0,ea.dj)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 z-50 shadow-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 flex-1",children:(0,t.jsxs)(m.$,{onClick:async()=>{if(window.confirm("This will clear all periods and reset the dashboard. Continue?")){f(!0);try{await l(),j({title:"Data Cleared",description:"Dashboard has been reset to default state."})}catch(e){j({title:"Clear Failed",description:"Unable to clear data. Please try again.",variant:"destructive"})}finally{f(!1)}}},variant:"outline",size:"sm",className:"flex items-center gap-1 px-3",disabled:p,children:[(0,t.jsx)(si.A,{className:"h-4 w-4 ".concat(p?"animate-spin":"")}),(0,t.jsx)("span",{className:"hidden sm:inline",children:p?"Clearing...":"Clear Data"})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.$,{onClick:n,variant:"outline",size:"sm",className:"px-3",children:(0,t.jsx)(Z.A,{className:"h-4 w-4"})}),(0,t.jsx)(sA,{reportData:d(),trigger:(0,t.jsx)(m.$,{variant:"outline",size:"sm",className:"px-3",children:(0,t.jsx)(sr.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(e4,{open:o,onOpenChange:x,children:[(0,t.jsx)(e2,{asChild:!0,children:(0,t.jsx)(m.$,{variant:"outline",size:"sm",className:"px-3",children:(0,t.jsx)(sl.A,{className:"h-4 w-4"})})}),(0,t.jsxs)(e6,{side:"bottom",className:"h-[75vh] overflow-y-auto max-h-[600px]",children:[(0,t.jsxs)(e8,{children:[(0,t.jsx)(e9,{children:"Dashboard Settings"}),(0,t.jsx)(e7,{children:"Configure your analytics dashboard"})]}),(0,t.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,t.jsx)(C.Zp,{children:(0,t.jsxs)(C.Wu,{className:"pt-4",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[(0,t.jsx)(sn.A,{className:"h-4 w-4"}),"Data Source"]}),(0,t.jsx)(sc,{onDataSelected:c,trigger:(0,t.jsxs)(m.$,{variant:"outline",className:"w-full justify-start",children:[(0,t.jsx)(eq.A,{className:"mr-2 h-4 w-4"}),"Configure Greyfinch Data"]})})]})}),(0,t.jsx)(ss,{open:h,onOpenChange:u,children:(0,t.jsx)(C.Zp,{children:(0,t.jsxs)(C.Wu,{className:"pt-4",children:[(0,t.jsx)(sa,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"ghost",className:"w-full justify-between p-0",children:[(0,t.jsxs)("span",{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(W.A,{className:"h-4 w-4"}),"Period Summary (",s.length,")"]}),(0,t.jsx)(el.A,{className:"h-4 w-4 transition-transform ".concat(h?"rotate-180":"")})]})}),(0,t.jsx)(st,{className:"space-y-3 mt-3",children:s.map(e=>{let s=a.find(s=>s.id.toString()===e.locationId);return(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e.title}),(0,t.jsx)(k,{variant:"secondary",className:"text-xs",children:(null==s?void 0:s.name)||"All Locations"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-600",children:e.startDate&&e.endDate?"".concat(new Date(e.startDate).toLocaleDateString()," - ").concat(new Date(e.endDate).toLocaleDateString()):"Select dates"})]},e.id)})})]})})}),(0,t.jsx)(C.Zp,{children:(0,t.jsxs)(C.Wu,{className:"pt-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Quick Actions"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m.$,{onClick:async()=>{window.confirm("This will clear all periods and reset the dashboard. Continue?")&&(await l(),x(!1))},variant:"outline",className:"w-full justify-start",children:[(0,t.jsx)(si.A,{className:"mr-2 h-4 w-4"}),"Clear All Data"]}),(0,t.jsx)(sg,{reportData:n(),reportName:"ORTHODASH Analytics Report",trigger:(0,t.jsxs)(m.$,{variant:"outline",className:"w-full justify-start",onClick:()=>x(!1),children:[(0,t.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"Export Report"]})}),(0,t.jsxs)(m.$,{onClick:()=>{d(),x(!1)},variant:"outline",className:"w-full justify-start",children:[(0,t.jsx)(sr.A,{className:"mr-2 h-4 w-4"}),"Share Dashboard"]})]})]})})]})]})]})]})]})}),(0,t.jsx)("div",{className:"hidden lg:block",children:(0,t.jsx)(C.Zp,{className:"mb-8",children:(0,t.jsxs)(C.Wu,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(sc,{onDataSelected:c}),(0,t.jsx)(sh,{}),(0,t.jsxs)(m.$,{onClick:async()=>{window.confirm("This will clear all periods and reset the dashboard. Continue?")&&await l()},variant:"outline",size:"sm",children:[(0,t.jsx)(si.A,{className:"mr-2 h-4 w-4"}),"Clear Data"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(sg,{reportData:n(),reportName:"ORTHODASH Analytics Report"}),(0,t.jsxs)(m.$,{onClick:d,variant:"outline",size:"sm",children:[(0,t.jsx)(sr.A,{className:"mr-2 h-4 w-4"}),"Share"]})]})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Active Periods:"}),s.map(e=>(0,t.jsx)(k,{variant:"secondary",children:e.title},e.id))]})]})})})]})}var sS=a(70203),sD=a(93129),sk=a(22517);function sP(e){let{onCostChange:s,initialCosts:a=[]}=e,[r,l]=(0,i.useState)(a),[n,d]=(0,i.useState)(null),[c,o]=(0,i.useState)({label:"",amount:0}),x=r.reduce((e,s)=>e+s.amount,0),h=i.useRef(x);i.useEffect(()=>{h.current!==x&&(h.current=x,s(x))},[x,s]);let p=(e,s)=>{l(a=>a.map(a=>a.id===e?{...a,...s}:a)),d(null)};return(0,t.jsxs)("div",{className:"space-y-4",children:[r.length>0&&(0,t.jsx)("div",{className:"space-y-3",children:r.map(e=>(0,t.jsx)(C.Zp,{className:"border border-gray-200",children:(0,t.jsx)(C.Wu,{className:"p-4",children:n===e.id?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(eY.p,{value:e.label,onChange:s=>p(e.id,{label:s.target.value}),className:"mb-2",placeholder:"Cost label"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eG.A,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,t.jsx)(eY.p,{type:"number",value:e.amount,onChange:s=>p(e.id,{amount:parseFloat(s.target.value)||0}),className:"pl-10",placeholder:"0.00",min:"0",step:"0.01"})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(m.$,{size:"sm",variant:"outline",onClick:()=>d(null),children:(0,t.jsx)(u.A,{className:"h-4 w-4"})}),(0,t.jsx)(m.$,{size:"sm",variant:"outline",onClick:()=>d(null),children:(0,t.jsx)(I.A,{className:"h-4 w-4"})})]})]}):(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.label}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",e.amount.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>d(e.id),children:(0,t.jsx)(sk.A,{className:"h-4 w-4"})}),(0,t.jsx)(m.$,{size:"sm",variant:"ghost",onClick:()=>{var s;return s=e.id,void l(e=>e.filter(e=>e.id!==s))},children:(0,t.jsx)(U.A,{className:"h-4 w-4"})})]})]})})},e.id))}),(0,t.jsx)(C.Zp,{className:"border-dashed border-gray-300",children:(0,t.jsx)(C.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"cost-label",className:"text-sm",children:"Cost Label"}),(0,t.jsx)(eY.p,{id:"cost-label",value:c.label,onChange:e=>o(s=>({...s,label:e.target.value})),placeholder:"e.g., Google Ads, Meta Advertising, Print Materials",className:"mt-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"cost-amount",className:"text-sm",children:"Amount"}),(0,t.jsxs)("div",{className:"relative mt-1",children:[(0,t.jsx)(eG.A,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,t.jsx)(eY.p,{id:"cost-amount",type:"number",value:c.amount||"",onChange:e=>o(s=>({...s,amount:parseFloat(e.target.value)||0})),className:"pl-10",placeholder:"0.00",min:"0",step:"0.01"})]})]}),(0,t.jsxs)(m.$,{onClick:()=>{if(c.label.trim()&&c.amount>0){let e={id:Date.now().toString(),label:c.label.trim(),amount:c.amount};l(s=>[...s,e]),o({label:"",amount:0})}},disabled:!c.label.trim()||c.amount<=0,className:"w-full",variant:"outline",children:[(0,t.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"Add Cost Entry"]})]})})}),(0,t.jsx)(C.Zp,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(C.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eG.A,{className:"h-5 w-5 text-green-600"}),(0,t.jsx)("span",{className:"font-medium",children:"Total Acquisition Costs"}),r.length>0&&(0,t.jsxs)(k,{variant:"secondary",children:[r.length," entries"]})]}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-green-700",children:["$",x.toLocaleString("en-US",{minimumFractionDigits:2})]})]})})})]})}function sR(e){let{locationId:s,period:a}=e,[l,n]=(0,i.useState)({manual_total:0,meta_ads:0,google_ads:0,other:0}),[d,c]=(0,i.useState)([]),[o,x]=(0,i.useState)({name:"",type:"meta",apiKey:"",apiSecret:"",accessToken:""}),[h,u]=(0,i.useState)(!1),{toast:p}=(0,ea.dj)(),f=(0,w.jE)(),{data:j}=(0,r.I)({queryKey:["/api/acquisition-costs",s,a],queryFn:async()=>{let e=await fetch("/api/acquisition-costs?locationId=".concat(s,"&period=").concat(a));if(!e.ok)throw Error("Failed to fetch costs");return e.json()}});(0,i.useEffect)(()=>{j&&n(j)},[j]);let g=(0,A.n)({mutationFn:async e=>(await V("POST","/api/acquisition-costs",{locationId:s,period:a,costs:e})).json(),onSuccess:()=>{p({title:"Costs Saved",description:"Acquisition costs have been saved successfully."}),f.invalidateQueries({queryKey:["/api/acquisition-costs"]})},onError:e=>{p({title:"Save Failed",description:e instanceof Error?e.message:"Failed to save costs",variant:"destructive"})}}),v=(0,A.n)({mutationFn:async e=>(await V("POST","/api/sync-external-costs",{configId:e,locationId:s,period:a})).json(),onSuccess:e=>{n(s=>({...s,...e.costs})),p({title:"Data Synced",description:"External advertising costs have been imported successfully."})},onError:e=>{p({title:"Sync Failed",description:e instanceof Error?e.message:"Failed to sync external data",variant:"destructive"})}});Object.values(l).reduce((e,s)=>e+s,0);let N=(0,i.useCallback)(e=>{n(s=>({...s,manual_total:e}))},[]);return(0,t.jsxs)(C.Zp,{className:"w-full",children:[(0,t.jsx)(C.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(eG.A,{className:"h-5 w-5 text-green-600"}),"Acquisition Cost Management"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(F,{open:h,onOpenChange:u,children:[(0,t.jsx)(T,{asChild:!0,children:(0,t.jsxs)(m.$,{variant:"outline",size:"sm",children:[(0,t.jsx)(sl.A,{className:"h-4 w-4 mr-2"}),"API Setup"]})}),(0,t.jsxs)(O,{children:[(0,t.jsx)(L,{children:(0,t.jsx)($,{children:"External API Configuration"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"api-name",children:"Configuration Name"}),(0,t.jsx)(eY.p,{id:"api-name",value:o.name,onChange:e=>x(s=>({...s,name:e.target.value})),placeholder:"e.g., Meta Business Account"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"api-type",children:"Platform"}),(0,t.jsxs)(ed,{value:o.type,onValueChange:e=>x(s=>({...s,type:e})),children:[(0,t.jsx)(eo,{children:(0,t.jsx)(ec,{})}),(0,t.jsxs)(eh,{children:[(0,t.jsx)(eu,{value:"meta",children:"Meta (Facebook/Instagram)"}),(0,t.jsx)(eu,{value:"google",children:"Google Ads"}),(0,t.jsx)(eu,{value:"quickbooks",children:"QuickBooks"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"api-key",children:"API Key"}),(0,t.jsx)(eY.p,{id:"api-key",type:"password",value:o.apiKey,onChange:e=>x(s=>({...s,apiKey:e.target.value})),placeholder:"Enter your API key"})]}),("meta"===o.type||"google"===o.type)&&(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"api-secret",children:"API Secret"}),(0,t.jsx)(eY.p,{id:"api-secret",type:"password",value:o.apiSecret,onChange:e=>x(s=>({...s,apiSecret:e.target.value})),placeholder:"Enter your API secret"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(ew.J,{htmlFor:"access-token",children:"Access Token (Optional)"}),(0,t.jsx)(eY.p,{id:"access-token",type:"password",value:o.accessToken,onChange:e=>x(s=>({...s,accessToken:e.target.value})),placeholder:"Enter access token if required"})]}),(0,t.jsxs)(m.$,{onClick:()=>{if(!o.name||!o.apiKey)return void p({title:"Invalid Configuration",description:"Please provide at least a name and API key.",variant:"destructive"});let e={id:Date.now().toString(),...o,isActive:!0};c(s=>[...s,e]),x({name:"",type:"meta",apiKey:"",apiSecret:"",accessToken:""}),u(!1),p({title:"Configuration Added",description:"".concat(e.name," API configuration has been added.")})},className:"w-full",children:[(0,t.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"Add Configuration"]})]})]})]}),(0,t.jsxs)(m.$,{onClick:()=>{g.mutate(l)},disabled:g.isPending,className:"bg-[#1d1d52] hover:bg-[#1d1d52]/90",children:[g.isPending?(0,t.jsx)(si.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,t.jsx)(eX.A,{className:"h-4 w-4 mr-2"}),"Save Costs"]})]})]})}),(0,t.jsx)(C.Wu,{children:(0,t.jsxs)(sS.tU,{defaultValue:"manual",className:"w-full",children:[(0,t.jsxs)(sS.j7,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(sS.Xi,{value:"manual",children:"Manual Entry"}),(0,t.jsx)(sS.Xi,{value:"automated",children:"API Integration"})]}),(0,t.jsx)(sS.av,{value:"manual",className:"space-y-6",children:(0,t.jsx)(sP,{onCostChange:N,initialCosts:[]})}),(0,t.jsx)(sS.av,{value:"automated",className:"space-y-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Configured APIs"}),(0,t.jsxs)(k,{variant:"secondary",children:[d.length," Active"]})]}),0===d.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(sD.A,{className:"h-8 w-8 mx-auto mb-3 text-gray-400"}),(0,t.jsx)("p",{children:"No API configurations found."}),(0,t.jsx)("p",{className:"text-sm",children:"Add your Meta, Google, or QuickBooks API credentials to automatically import advertising spend."})]}):(0,t.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 capitalize",children:[e.type," API"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(k,{variant:e.isActive?"default":"secondary",children:e.isActive?"Active":"Inactive"}),(0,t.jsxs)(m.$,{variant:"outline",size:"sm",onClick:()=>v.mutate(e.id),disabled:v.isPending,children:[v.isPending?(0,t.jsx)(si.A,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(si.A,{className:"h-4 w-4"}),"Sync"]})]})]},e.id))})]})})]})})]})}var sI=a(33885);function sF(e){let{periods:s,periodData:a}=e,[r,l]=(0,i.useState)(null),{toast:n}=(0,ea.dj)(),d=(0,A.n)({mutationFn:async e=>{let s=await V("POST","/api/generate-summary",e);return await s.json()},onSuccess:e=>{l(e),n({title:"AI Summary Generated",description:"Your analytics summary has been generated successfully."})},onError:e=>{n({title:"Generation Failed",description:e instanceof Error?e.message:"Failed to generate summary",variant:"destructive"})}});return(0,t.jsxs)(C.Zp,{className:"w-full",children:[(0,t.jsx)(C.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(C.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(sI.A,{className:"h-5 w-5 text-[#1d1d52]"}),"AI Analytics Summary"]}),(0,t.jsx)(m.$,{onClick:()=>{d.mutate({periods:s,periodData:a})},disabled:d.isPending||0===Object.keys(a).length,className:"bg-[#1d1d52] hover:bg-[#1d1d52]/90 text-white",children:d.isPending?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(sj.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(sI.A,{className:"mr-2 h-4 w-4"}),"Generate Summary"]})})]})}),r&&(0,t.jsxs)(C.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(e_.A,{className:"h-4 w-4 text-[#1d1d52]"}),(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"Recommendations"}),(0,t.jsx)(k,{variant:"secondary",children:"ROAS Optimization"})]}),(0,t.jsx)("ul",{className:"space-y-2",children:r.recommendations.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-[#1d1d52] rounded-full mt-2 flex-shrink-0"}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e})]},s))})]}),(0,t.jsx)(sN,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(X.A,{className:"h-4 w-4 text-[#1d1d52]"}),(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"Deep Dive Insights"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[r.deepDive.insights.map((e,s)=>(0,t.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e},s)),r.deepDive.externalLinks.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Additional Resources:"}),(0,t.jsx)("div",{className:"space-y-2",children:r.deepDive.externalLinks.map((e,s)=>(0,t.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-start gap-2 p-2 rounded-lg border border-gray-200 hover:border-[#1d1d52] transition-colors group",children:[(0,t.jsx)(sx.A,{className:"h-4 w-4 text-gray-400 group-hover:text-[#1d1d52] mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-sm group-hover:text-[#1d1d52]",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]},s))})]})]})]}),(0,t.jsx)(sN,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(X.A,{className:"h-4 w-4 text-[#1d1d52]"}),(0,t.jsx)("h3",{className:"font-semibold text-lg",children:"Comparative Analysis"}),(0,t.jsx)(k,{variant:"outline",children:"vs National Averages"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:Object.entries(r.comparativeAnalysis.nationalAverages).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:s}),(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:a})]},s)})}),(0,t.jsx)("div",{className:"space-y-2",children:r.comparativeAnalysis.performance.map((e,s)=>(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e},s))})]})]}),!r&&!d.isPending&&(0,t.jsx)(C.Wu,{children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(sI.A,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:'Select time periods and click "Generate Summary" to get AI-powered insights about your practice performance.'})]})})]})}function sT(){let[e,s]=(0,i.useState)(()=>{try{let e=localStorage.getItem("orthodash-periods");if(e)return JSON.parse(e).map(e=>({...e,startDate:e.startDate?new Date(e.startDate):void 0,endDate:e.endDate?new Date(e.endDate):void 0}))}catch(e){console.error("Error loading saved periods:",e)}return[{id:"period-1",name:"Period A",title:"Period A",locationId:"all",startDate:void 0,endDate:void 0}]});(0,i.useEffect)(()=>{try{localStorage.setItem("orthodash-periods",JSON.stringify(e))}catch(e){console.error("Error saving periods:",e)}},[e]);let{data:a=[]}=(0,r.I)({queryKey:["/api/locations"]}),l=e.map(e=>{let s="all"===e.locationId?"":"&locationId=".concat(e.locationId);return(0,r.I)({queryKey:["/api/analytics",e.id,e.locationId,e.startDate?(0,B.GP)(e.startDate,"yyyy-MM-dd"):"no-start",e.endDate?(0,B.GP)(e.endDate,"yyyy-MM-dd"):"no-end"],queryFn:async()=>{if(!e.startDate||!e.endDate)return console.log("Period ".concat(e.id," missing dates:"),{startDate:e.startDate,endDate:e.endDate}),null;let a=(0,B.GP)(e.startDate,"yyyy-MM-dd"),t=(0,B.GP)(e.endDate,"yyyy-MM-dd"),i="/api/analytics?startDate=".concat(a,"&endDate=").concat(t).concat(s);console.log("Fetching analytics for period ".concat(e.id,":"),i);let r=await fetch(i);if(!r.ok){let s=await r.text();throw console.error("Analytics fetch failed for ".concat(e.id,":"),r.status,s),Error("Failed to fetch analytics: ".concat(r.status," ").concat(s))}let l=await r.json();return console.log("Analytics data received for ".concat(e.id,":"),l),l},enabled:!!(e.startDate&&e.endDate),retry:2,refetchOnMount:!0,refetchOnWindowFocus:!1})}),n=a=>{if(console.log("Dashboard handleAddPeriod called with:",a),console.log("Current periods count:",e.length),e.length>=10){console.error("Maximum 10 periods allowed"),alert("Maximum 10 periods allowed");return}try{if(!a.title)throw Error("Period title is required");let e=a.startDate,t=a.endDate;if(!e||e instanceof Date||(console.log("Converting startDate to Date object:",e),e=new Date(e)),!t||t instanceof Date||(console.log("Converting endDate to Date object:",t),t=new Date(t)),!e||!t)throw Error("Start and end dates are required");if(isNaN(e.getTime())||isNaN(t.getTime()))throw Error("Invalid date values provided");if(e>=t)throw Error("Start date must be before end date");let i={...a,id:"period-".concat(Date.now()),startDate:e,endDate:t};console.log("Creating new period:",i),console.log("Start date type:",typeof i.startDate,i.startDate),console.log("End date type:",typeof i.endDate,i.endDate),s(e=>{let s=[...e,i];return console.log("Updated periods array:",s),s}),console.log("Period added successfully")}catch(s){console.error("Error adding period:",s);let e=s instanceof Error?s.message:"Unknown error occurred";alert("Error adding period: ".concat(e))}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-24 lg:pb-8",children:[(0,t.jsx)(K,{}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 lg:py-8",children:[(0,t.jsx)(sC,{periods:e,locations:a,onAddPeriod:n,onClearData:()=>(s([{id:"period-1",name:"Period A",title:"Period A",locationId:"all",startDate:new Date,endDate:new Date}]),localStorage.removeItem("orthodash-periods"),localStorage.removeItem("orthodash-dashboard-state"),Promise.resolve()),onExport:()=>({periods:e,periodQueries:l.map(e=>e.data),locations:a,timestamp:new Date}),onShare:()=>({periods:e,periodData:Object.fromEntries(l.map((s,a)=>[e[a].id,s.data||{}]).filter(e=>{let[s,a]=e;return Object.keys(a).length>0})),locations:a,timestamp:new Date().toISOString(),title:"ORTHODASH Analytics Report - ".concat(new Date().toLocaleDateString()),summary:{totalPeriods:e.length,hasData:l.some(e=>e.data&&Object.keys(e.data).length>0),dateRange:e.length>0?"".concat(e[0].startDate||"No start"," - ").concat(e[0].endDate||"No end"):"No periods"}}),onGreyfinchDataSelected:e=>{console.log("Greyfinch data selection:",e)}}),(0,t.jsx)(e0,{periods:e,locations:a,periodQueries:l,onAddPeriod:n,onRemovePeriod:a=>{e.length>1&&s(e=>e.filter(e=>e.id!==a))},onUpdatePeriod:(e,a)=>{s(s=>s.map(s=>s.id===e?{...s,...a}:s))}}),(0,t.jsx)("div",{className:"mt-8",children:(0,t.jsx)(sF,{periods:e,periodData:Object.fromEntries(l.map((s,a)=>[e[a].id,s.data||{}]).filter(e=>{let[s,a]=e;return Object.keys(a).length>0}))})}),(0,t.jsx)("div",{className:"hidden lg:block mt-8",children:(0,t.jsx)(sR,{locationId:null,period:"2024-Q1"})})]})]})}},56680:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(69241),i=a(29573);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,i.QP)((0,t.$)(s))}},67580:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return a(55575)}])},70203:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>c,av:()=>o,j7:()=>d,tU:()=>n});var t=a(37876),i=a(14232),r=a(34677),l=a(56680);let n=r.bL,d=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...i})});d.displayName=r.B8.displayName;let c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...i})});c.displayName=r.l9.displayName;let o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});o.displayName=r.UC.displayName},84399:(e,s,a)=>{"use strict";a.d(s,{As:()=>l}),a(37876);var t=a(14232);a(43579);var i=a(72170);a(65364),(0,i.UU)("https://kehjphirpsryupvqknmy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtlaGpwaGlycHNyeXVwdnFrbm15Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxNDA0OTcsImV4cCI6MjA3MTcxNjQ5N30.CVqmrQRVudOAcScg4AT3D1bALj_mgSx7kPjqHfr5uL0");let r=(0,t.createContext)(null);function l(){let e=(0,t.useContext)(r);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},91725:(e,s,a)=>{"use strict";a.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>l,aR:()=>n});var t=a(37876),i=a(14232),r=a(56680);let l=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...i})});l.displayName="Card";let n=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...i})});n.displayName="CardHeader";let d=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...i})});d.displayName="CardTitle";let c=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a),...i})});c.displayName="CardDescription";let o=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",a),...i})});o.displayName="CardContent",i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a),...i})}).displayName="CardFooter"}},e=>{e.O(0,[429,511,966,636,593,792],()=>e(e.s=67580)),_N_E=e.O()}]);